<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geographic Detective Academy - World Geography Simulation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }

        .header {
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo h1 {
            color: #ffd700;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .logo .subtitle {
            color: #cccccc;
            font-size: 0.9rem;
            font-weight: normal;
        }

        .status-badges {
            display: flex;
            gap: 1rem;
        }

        .badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .classified {
            background: #dc3545;
            color: white;
        }

        .active-case {
            background: #28a745;
            color: white;
        }

        .navigation {
            background: rgba(0, 0, 0, 0.6);
            padding: 0;
            display: flex;
            overflow-x: auto;
            border-bottom: 2px solid #ffd700;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
            min-width: fit-content;
        }

        .nav-item:hover {
            background: rgba(255, 215, 0, 0.2);
            border-bottom-color: #ffd700;
        }

        .nav-item.active {
            background: rgba(255, 215, 0, 0.3);
            border-bottom-color: #ffd700;
        }

        .nav-item .icon {
            font-size: 1.2rem;
        }

        .nav-item .label {
            font-weight: 500;
        }

        .main-content {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .content-panel {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin-bottom: 2rem;
        }

        .simulation-title {
            text-align: center;
            margin-bottom: 2rem;
        }

        .simulation-title h2 {
            color: #1e3c72;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .simulation-title .mystery-title {
            color: #2a5298;
            font-size: 1.5rem;
            font-style: italic;
        }

        .overview-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .overview-section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #ffd700;
        }

        .overview-section h3 {
            color: #1e3c72;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .schedule-item {
            background: white;
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 5px;
            border-left: 3px solid #28a745;
        }

        .day-label {
            font-weight: bold;
            color: #1e3c72;
        }

        .hidden {
            display: none;
        }

        .case-file {
            background: linear-gradient(145deg, #ffe4e1, #ffd700);
            border: 2px solid #dc3545;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            color: #333;
        }

        .case-header {
            background: #dc3545;
            color: white;
            padding: 0.5rem 1rem;
            margin: -1.5rem -1.5rem 1rem -1.5rem;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            text-transform: uppercase;
        }

        .evidence-list {
            list-style: none;
            padding: 0;
        }

        .evidence-list li {
            background: rgba(255, 255, 255, 0.8);
            margin: 0.5rem 0;
            padding: 0.8rem;
            border-radius: 5px;
            border-left: 3px solid #28a745;
        }

        .coordinate-highlight {
            background: #ffd700;
            color: #333;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .overview-content {
                grid-template-columns: 1fr;
            }
            
            .header {
                flex-direction: column;
                gap: 1rem;
            }
            
            .navigation {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            <span style="font-size: 2rem;">üîç</span>
            <div>
                <h1>Geographic Detective Academy</h1>
                <div class="subtitle">Q1 Simulation - The Mystery of the Missing Maps</div>
            </div>
        </div>
        <div class="status-badges">
            <div class="badge classified">CLASSIFIED</div>
            <div class="badge active-case">ACTIVE CASE</div>
        </div>
    </header>

    <nav class="navigation">
        <div class="nav-item active" data-panel="overview">
            <span class="icon">üìã</span>
            <span class="label">Overview</span>
        </div>
        <div class="nav-item" data-panel="daily-structure">
            <span class="icon">üìÖ</span>
            <span class="label">Daily Structure</span>
        </div>
        <div class="nav-item" data-panel="team-roles">
            <span class="icon">üë•</span>
            <span class="label">Team Roles</span>
        </div>
        <div class="nav-item" data-panel="investigation-events">
            <span class="icon">‚ö†Ô∏è</span>
            <span class="label">Investigation Events</span>
        </div>
        <div class="nav-item" data-panel="assessments">
            <span class="icon">üìä</span>
            <span class="label">Assessments</span>
        </div>
        <div class="nav-item" data-panel="teacher-guide">
            <span class="icon">üìñ</span>
            <span class="label">Teacher Guide</span>
        </div>
        <div class="nav-item" data-panel="student-materials">
            <span class="icon">üìã</span>
            <span class="label">Student Materials</span>
        </div>
        <div class="nav-item" data-panel="gamma-prompts">
            <span class="icon">üìΩÔ∏è</span>
            <span class="label">Presentation</span>
        </div>
        <div class="nav-item" data-panel="complete-package">
            <span class="icon">üì¶</span>
            <span class="label">Complete Package</span>
        </div>
    </nav>

    <main class="main-content">
        <!-- OVERVIEW PANEL -->
        <div id="overview" class="content-panel">
            <div class="simulation-title">
                <h2>Q1: Geographic Detectives Simulation</h2>
                <div class="mystery-title">"The Mystery of the Missing Maps Academy"</div>
            </div>

            <div class="overview-content">
                <div class="overview-section">
                    <h3>üéØ SIMULATION OVERVIEW</h3>
                    <p>Students become rookie detectives at the International Geographic Bureau investigating the disappearance of the world's most important maps and geographic artifacts. Over 12 days, they'll solve increasingly complex cases using geographic skills, knowledge of early civilizations, and collaborative problem-solving.</p>
                    
                    <div class="case-file">
                        <div class="case-header">üö® URGENT: Global Geographic Crisis</div>
                        <p><strong>The world's most valuable geographic artifacts have vanished!</strong></p>
                        <ul>
                            <li>Ancient maps from early civilizations - STOLEN</li>
                            <li>Modern GPS technology - COMPROMISED</li>
                            <li>International boundaries at risk</li>
                            <li>Global navigation systems failing worldwide</li>
                        </ul>
                        <p><strong>Time is running out. The world needs heroes.</strong></p>
                    </div>
                </div>

                <div class="overview-section">
                    <h3>üìÖ SCHEDULE</h3>
                    <div class="schedule-item">
                        <div class="day-label">Setup Day (Day 0):</div>
                        Character creation, team formation, introduction to the Bureau
                    </div>
                    <div class="schedule-item">
                        <div class="day-label">Investigation Days (Days 1-10):</div>
                        Progressive cases building geographic skills
                    </div>
                    <div class="schedule-item">
                        <div class="day-label">Wrap-up Day (Day 11):</div>
                        Final case presentation and summative assessment
                    </div>
                </div>
            </div>

            <div class="overview-content">
                <div class="overview-section">
                    <h3>üìñ THE STORY</h3>
                    <p>The year is 2025, and the International Geographic Bureau's most precious collection has been stolen: ancient maps from early civilizations, modern geographic tools, and classified location data.</p>
                    
                    <p><strong>You are the world's last hope.</strong> As rookie detectives, students must:</p>
                    <ul>
                        <li>Master geographic detective skills</li>
                        <li>Learn to read landscapes like fingerprints</li>
                        <li>Solve increasingly complex cases</li>
                        <li>Track down international criminals</li>
                        <li>Follow geographic clues across continents</li>
                        <li>Graduate as certified Geographic Crime Specialists</li>
                    </ul>
                </div>

                <div class="overview-section">
                    <h3>üèÜ BADGE PROGRESSION</h3>
                    <div class="schedule-item">
                        <div class="day-label">ü•â Rookie:</div>
                        Basic geographic skills and observation
                    </div>
                    <div class="schedule-item">
                        <div class="day-label">ü•à Detective:</div>
                        Advanced case-solving and analysis
                    </div>
                    <div class="schedule-item">
                        <div class="day-label">ü•á Specialist:</div>
                        Expert geographic crime investigation
                    </div>
                    <p><em>Each case builds your geographic expertise and credentials.</em></p>
                </div>
            </div>
        </div>

        <!-- DAILY STRUCTURE PANEL -->
        <div id="daily-structure" class="content-panel hidden">
            <h2>üìÖ Daily Structure</h2>
            <p>Detailed daily progression and activities will be loaded here...</p>
        </div>

        <!-- TEAM ROLES PANEL -->
        <div id="team-roles" class="content-panel hidden">
            <h2>üë• Team Roles</h2>
            <p>Detective unit roles and responsibilities will be loaded here...</p>
        </div>

        <!-- INVESTIGATION EVENTS PANEL -->
        <div id="investigation-events" class="content-panel hidden">
            <h2>‚ö†Ô∏è Investigation Events</h2>
            
            <div class="case-file">
                <div class="case-header">Case File #001: The Great Globe Heist</div>
                <p><strong>ROOKIE LEVEL - GEOGRAPHIC FUNDAMENTALS TRAINING</strong></p>
                
                <div class="overview-content">
                    <div>
                        <h4>üìç Crime Scene Details</h4>
                        <ul>
                            <li><strong>Location:</strong> Roosevelt Middle School, Room 204</li>
                            <li><strong>Time:</strong> Tuesday, 3:15 PM</li>
                            <li><strong>Missing Item:</strong> 12-inch classroom globe</li>
                            <li><strong>Threat Level:</strong> Low</li>
                            <li><strong>Required Skills:</strong> Basic geography, observation, coordinate reading</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4>üîç Evidence Found</h4>
                        <ul class="evidence-list">
                            <li>Empty globe stand with dust outline</li>
                            <li>Fingerprints on metal base</li>
                            <li>Torn paper with coordinates: <span class="coordinate-highlight">40¬∞N, 74¬∞W</span></li>
                            <li>Compass left behind pointing northeast</li>
                            <li>World map on wall with pin missing</li>
                        </ul>
                    </div>
                </div>
                
                <p><strong>Investigation Question:</strong> The coordinates <span class="coordinate-highlight">40¬∞N, 74¬∞W</span> were found on torn paper - what could this mean?</p>
            </div>
        </div>

        <!-- ASSESSMENTS PANEL -->
        <div id="assessments" class="content-panel hidden">
            <h2>üìä Assessments</h2>
            <p>Assessment rubrics and evaluation methods will be loaded here...</p>
        </div>

        <!-- TEACHER GUIDE PANEL -->
        <div id="teacher-guide" class="content-panel hidden">
            <h2>üìñ Teacher Guide</h2>
            <p>Instructor resources and guidance will be loaded here...</p>
        </div>

        <!-- STUDENT MATERIALS PANEL -->
        <div id="student-materials" class="content-panel hidden">
            <h2>üìã Student Materials</h2>
            <p>Handouts, worksheets, and student resources will be loaded here...</p>
        </div>

        <!-- PRESENTATION PANEL -->
        <div id="gamma-prompts" class="content-panel hidden">
            <h2>üìΩÔ∏è Interactive Presentation</h2>
            <p>Interactive elements and prompts will be loaded here...</p>
        </div>

        <!-- COMPLETE PACKAGE PANEL -->
        <div id="complete-package" class="content-panel hidden">
            <h2>üì¶ Complete Package</h2>
            <p>Full simulation bundle and resources will be loaded here...</p>
        </div>
    </main>

    <script>
        // Navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            const panels = document.querySelectorAll('.content-panel');

            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const targetPanel = this.getAttribute('data-panel');
                    
                    // Remove active class from all nav items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Hide all panels
                    panels.forEach(panel => panel.classList.add('hidden'));
                    
                    // Show target panel
                    const targetElement = document.getElementById(targetPanel);
                    if (targetElement) {
                        targetElement.classList.remove('hidden');
                    }
                });
            });
        });
    </script>
    
    <!-- Load dynamic content system -->
    <script src="/simulation-dynamic.js"></script>
    
    <!-- Load presentation system -->
    <script>
        // Include presentation system inline for immediate availability
        /**
         * Geographic Detective Academy Presentation System
         * Integrates the 60-slide presentation directly into the simulation interface
         */

        class SimulationPresentation {
            constructor() {
                this.currentSlide = 1;
                this.totalSlides = 60;
                this.slidesPath = '/slides/';
                this.fullscreenMode = false;
                this.autoPlay = false;
                this.slideNotes = {};
                
                // Map slide numbers to actual filenames
                this.slideFilenames = {
                    1: "1_Geographic-Detective-Academy.png",
                    2: "2_URGENT-Global-Geographic-Crisis.png",
                    3: "3_Your-Mission-Become-Geographic-Crime-Specialists.png",
                    4: "4_Evidence-Manager.png",
                    5: "5_Your-Path-to-Mastery.png",
                    6: "6_CASE-FILE-001.png",
                    7: "7_Day-1-The-Great-Globe-Heist.png",
                    8: "8_Crime-Scene-Investigation.png",
                    9: "9_Witness-Interview-Janitor-Bob.png",
                    10: "10_Your-First-Geographic-Challenge.png",
                    11: "11_CASE-SOLVED.png",
                    12: "12_Skills-Earned-Day-1.png",
                    13: "13_CASE-FILE-002.png",
                    14: "14_Day-2-Mountains-of-Mystery.png",
                    15: "15_Crime-Scene-Survey-Office-Break-In.png",
                    16: "16_Witness-Interview-Dr-Sarah-Chen-Chief-Cartographer.png",
                    17: "17_Physical-Geography-Challenge.png",
                    18: "18_Elevation-Detective-Work.png",
                    19: "19_CASE-SOLVED.png",
                    20: "20_Skills-Earned-Day-2.png",
                    21: "21_CASE-FILE-003.png",
                    22: "22_Day-3-International-Heritage-Heist.png",
                    23: "23_Stolen-Cultural-Treasures.png",
                    24: "24_Witness-Interview-Museum-Director-Maria-Santos.png",
                    25: "25_Geographic-Culture-Connection.png",
                    26: "26_Cultural-Geography-Challenge.png",
                    27: "27_CASE-SOLVED.png",
                    28: "28_Skills-Earned-Day-3.png",
                    29: "29_CASE-FILE-004-005.png",
                    30: "30_Days-4-5-Economic-Espionage.png",
                    31: "31_Multi-Day-Investigation-Economic-Intelligence-Theft.png",
                    32: "32_Economic-Geography-Understanding-Trade.png",
                    33: "33_Witness-Interview-Trade-Specialist-Dr-James-Morrison.png",
                    34: "34_Resource-Geography-Challenge.png",
                    35: "35_Government-Systems-Under-Attack.png",
                    36: "36_Economic-Crime-Pattern-Analysis.png",
                    37: "37_CASE-SOLVED.png",
                    38: "38_Skills-Earned-Days-4-5.png",
                    39: "39_CASE-FILE-006-008.png",
                    40: "40_Days-6-8-Archaeological-Adventure.png",
                    41: "41_Multi-Site-Archaeological-Crime-Scene.png",
                    42: "42_River-Valley-Civilizations-Pattern.png",
                    43: "43_Witness-Interview-Dr-Elena-Rodriguez-Lead-Archaeologist.png",
                    44: "44_Ancient-Geographic-Technology.png",
                    45: "45_Historical-Geography-Challenge.png",
                    46: "46_Ancient-Civilization-Geographic-Comparison.png",
                    47: "47_CASE-SOLVED.png",
                    48: "48_Skills-Earned-Days-6-8.png",
                    49: "49_CASE-FILE-009-011.png",
                    50: "50_Days-9-11-The-Final-Confrontation.png",
                    51: "51_The-Cartographers-Master-Plan-Revealed.png",
                    52: "52_Global-Criminal-Network-Analysis.png",
                    53: "53_Elite-Task-Force-Assembly.png",
                    54: "54_Advanced-Geographic-Intelligence-Challenge.png",
                    55: "55_The-Cartographers-Location-Discovered.png",
                    56: "56_Epic-Geographic-Skills-Integration.png",
                    57: "57_The-Final-Confrontation.png",
                    58: "58_ULTIMATE-VICTORY.png",
                    59: "59_Your-Geographic-Detective-Academy-Graduation.png",
                    60: "60_Your-Geographic-Legacy.png"
                };
                
                this.initializePresentation();
            }

            initializePresentation() {
                this.createPresentationInterface();
                this.setupKeyboardNavigation();
                this.loadSlideNotes();
                // Initialize the first slide
                this.updateSlide();
            }

            createPresentationInterface() {
                const presentationHTML = `
                    <div id="presentation-container" class="presentation-container">
                        <div class="presentation-header">
                            <div class="presentation-title">
                                <h2>üïµÔ∏è Geographic Detective Academy Presentation</h2>
                                <div class="slide-counter">Slide <span id="current-slide">1</span> of ${this.totalSlides}</div>
                            </div>
                            <div class="presentation-controls">
                                <button class="btn-control" onclick="presentation.toggleFullscreen()">
                                    <span class="icon">‚õ∂</span> Fullscreen
                                </button>
                                <button class="btn-control" onclick="presentation.toggleAutoPlay()">
                                    <span class="icon">‚ñ∂Ô∏è</span> Auto Play
                                </button>
                                <button class="btn-control" onclick="presentation.downloadSlide()">
                                    <span class="icon">üì•</span> Download
                                </button>
                            </div>
                        </div>

                        <div class="presentation-viewer">
                        <div class="slide-container">
                            <!-- Actual slide image for GridFS slides -->
                            <img id="current-slide-image" 
                                 src="/slides/1_Geographic-Detective-Academy.png" 
                                 alt="Geographic Detective Academy - Slide 1"
                                 class="slide-image">
                            
                            <!-- Fallback placeholder if slides don't load -->
                            <div id="current-slide-placeholder" class="slide-placeholder" style="display: none;">
                                <div class="placeholder-content">
                                    <div class="placeholder-icon">üïµÔ∏è</div>
                                    <h3>Geographic Detective Academy</h3>
                                    <p>Slide <span id="current-slide-number">1</span> of ${this.totalSlides}</p>
                                    <div class="placeholder-note">
                                        <strong>Note:</strong> Slide images are served locally only.<br>
                                        Full presentation available in development environment.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="slide-overlay">
                                <button class="nav-btn prev-btn" onclick="presentation.previousSlide()">
                                    <span class="icon">‚óÄÔ∏è</span>
                                </button>
                                <button class="nav-btn next-btn" onclick="presentation.nextSlide()">
                                    <span class="icon">‚ñ∂Ô∏è</span>
                                </button>
                            </div>

                            <div class="slide-annotations" id="slide-annotations">
                                <!-- Dynamic annotations will be loaded here -->
                            </div>
                        </div>                            <div class="slide-notes-panel" id="slide-notes-panel">
                                <h4>üìù Slide Notes & Key Points</h4>
                                <div id="slide-notes-content">
                                    Loading slide notes...
                                </div>
                            </div>
                        </div>

                        <div class="presentation-footer">
                            <div class="slide-thumbnails" id="slide-thumbnails">
                                <!-- Thumbnail navigation will be generated here -->
                            </div>
                            
                            <div class="presentation-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${(1/this.totalSlides) * 100}%"></div>
                                </div>
                                <div class="slide-timer" id="slide-timer">00:00</div>
                            </div>
                        </div>
                    </div>
                `;

                return presentationHTML;
            }

            // Add presentation panel to existing simulation
            addToPresentationPanel() {
                const presentationPanel = document.getElementById('gamma-prompts');
                if (presentationPanel) {
                    presentationPanel.innerHTML = `
                        <h2>üìΩÔ∏è Interactive Presentation</h2>
                        <p class="subtitle">Navigate through the complete Geographic Detective Academy presentation</p>
                        ${this.createPresentationInterface()}
                    `;
                    
                    // Force immediate slide initialization after DOM is ready
                    setTimeout(() => {
                        this.initializeSlideDisplay();
                    }, 100);
                }
            }

            initializeSlideDisplay() {
                const slideImage = document.getElementById('current-slide-image');
                const placeholder = document.getElementById('current-slide-placeholder');
                
                if (slideImage && placeholder) {
                    console.log('üé¨ Initializing presentation with 60 slides from MongoDB GridFS');
                    
                    // Set up error handling first
                    slideImage.onerror = () => {
                        console.warn(`‚ö†Ô∏è Slide ${this.currentSlide} failed to load, showing placeholder`);
                        slideImage.style.display = 'none';
                        placeholder.style.display = 'flex';
                    };
                    
                    // Set up success handling
                    slideImage.onload = () => {
                        console.log(`‚úÖ Slide ${this.currentSlide} loaded successfully`);
                        slideImage.style.display = 'block';
                        placeholder.style.display = 'none';
                    };
                    
                    // Start with first slide
                    this.updateSlide();
                } else {
                    console.error('‚ùå Presentation elements not found');
                }
            }

            nextSlide() {
                if (this.currentSlide < this.totalSlides) {
                    this.currentSlide++;
                    this.updateSlide();
                }
            }

            previousSlide() {
                if (this.currentSlide > 1) {
                    this.currentSlide--;
                    this.updateSlide();
                }
            }

            goToSlide(slideNumber) {
                if (slideNumber >= 1 && slideNumber <= this.totalSlides) {
                    this.currentSlide = slideNumber;
                    this.updateSlide();
                }
            }

            updateSlide() {
                const slideNumber = document.getElementById('current-slide-number');
                const slideCounter = document.getElementById('current-slide');
                const progressFill = document.querySelector('.progress-fill');
                const slideImage = document.getElementById('current-slide-image');

                if (slideNumber) {
                    slideNumber.textContent = this.currentSlide;
                }

                if (slideCounter) {
                    slideCounter.textContent = this.currentSlide;
                }

                if (progressFill) {
                    progressFill.style.width = `${(this.currentSlide / this.totalSlides) * 100}%`;
                }

                // Update the slide image source
                if (slideImage) {
                    const slideFilename = this.slideFilenames[this.currentSlide];
                    if (slideFilename) {
                        console.log(`üîÑ Loading slide ${this.currentSlide}: ${slideFilename}`);
                        slideImage.src = `/slides/${slideFilename}`;
                        slideImage.alt = `Geographic Detective Academy - Slide ${this.currentSlide}`;
                    } else {
                        console.error(`‚ùå No filename mapping for slide ${this.currentSlide}`);
                    }
                }

                this.updateSlideNotes();
            }

            updateSlideNotes() {
                const notesContent = document.getElementById('slide-notes-content');
                if (notesContent) {
                    const notes = this.slideNotes[this.currentSlide] || this.getDefaultSlideNotes();
                    notesContent.innerHTML = `
                        <div class="slide-note-item">
                            <h5>üéØ Key Learning Objectives:</h5>
                            <ul>
                                ${notes.objectives.map(obj => `<li>${obj}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="slide-note-item">
                            <h5>üó£Ô∏è Discussion Points:</h5>
                            <ul>
                                ${notes.discussion.map(point => `<li>${point}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="slide-note-item">
                            <h5>üîó Geographic Connections:</h5>
                            <p>${notes.geographicConnection}</p>
                        </div>
                    `;
                }
            }

            getDefaultSlideNotes() {
                // Provide default notes structure based on slide ranges
                if (this.currentSlide <= 10) {
                    return {
                        objectives: ["Introduction to Geographic Detective Academy", "Understanding the simulation framework", "Setting up investigation mindset"],
                        discussion: ["What makes a good detective?", "How do geographic skills help solve mysteries?", "What tools do geographers use?"],
                        geographicConnection: "Foundation geographic concepts and spatial thinking skills."
                    };
                } else if (this.currentSlide <= 30) {
                    return {
                        objectives: ["Team role assignments", "Investigation procedures", "Geographic tool usage"],
                        discussion: ["How do different roles contribute to investigation?", "What evidence is most important?", "How do we analyze geographic clues?"],
                        geographicConnection: "Practical application of geographic themes and spatial analysis."
                    };
                } else if (this.currentSlide <= 50) {
                    return {
                        objectives: ["Case study analysis", "Advanced geographic concepts", "Problem-solving strategies"],
                        discussion: ["What patterns do you notice?", "How does this connect to real-world geography?", "What would you do differently?"],
                        geographicConnection: "Complex geographic relationships and systems thinking."
                    };
                } else {
                    return {
                        objectives: ["Assessment and reflection", "Real-world applications", "Next steps and extensions"],
                        discussion: ["What did you learn?", "How will you use these skills?", "What questions do you still have?"],
                        geographicConnection: "Integration and application of all geographic concepts learned."
                    };
                }
            }

            generateThumbnails() {
                const thumbnailContainer = document.getElementById('slide-thumbnails');
                if (!thumbnailContainer) return;

                const slideFiles = [
                    '1_Geographic-Detective-Academy.png',
                    '2_URGENT-Global-Geographic-Crisis.png',
                    '3_Your-Mission-Become-Geographic-Crime-Specialists.png',
                    '4_Evidence-Manager.png',
                    '5_Your-Path-to-Mastery.png',
                    '6_CASE-FILE-001.png',
                    '7_Day-1-The-Great-Globe-Heist.png',
                    '8_Crime-Scene-Investigation.png',
                    '9_Witness-Interview-Janitor-Bob.png',
                    '10_Your-First-Geographic-Challenge.png',
                    '11_CASE-SOLVED.png',
                    '12_Skills-Earned-Day-1.png',
                    '13_CASE-FILE-002.png',
                    '14_Day-2-Mountains-of-Mystery.png',
                    '15_Crime-Scene-Survey-Office-Break-In.png',
                    '16_Witness-Interview-Dr-Sarah-Chen-Chief-Cartographer.png',
                    '17_Physical-Geography-Challenge.png',
                    '18_Elevation-Detective-Work.png',
                    '19_CASE-SOLVED.png',
                    '20_Skills-Earned-Day-2.png',
                    '21_CASE-FILE-003.png',
                    '22_Day-3-International-Heritage-Heist.png',
                    '23_Stolen-Cultural-Treasures.png',
                    '24_Witness-Interview-Museum-Director-Maria-Santos.png',
                    '25_Geographic-Culture-Connection.png',
                    '26_Cultural-Geography-Challenge.png',
                    '27_CASE-SOLVED.png',
                    '28_Skills-Earned-Day-3.png',
                    '29_CASE-FILE-004-005.png',
                    '30_Days-4-5-Economic-Espionage.png',
                    '31_Multi-Day-Investigation-Economic-Intelligence-Theft.png',
                    '32_Economic-Geography-Understanding-Trade.png',
                    '33_Witness-Interview-Trade-Specialist-Dr-James-Morrison.png',
                    '34_Resource-Geography-Challenge.png',
                    '35_Government-Systems-Under-Attack.png',
                    '36_Economic-Crime-Pattern-Analysis.png',
                    '37_CASE-SOLVED.png',
                    '38_Skills-Earned-Days-4-5.png',
                    '39_CASE-FILE-006-008.png',
                    '40_Days-6-8-Archaeological-Adventure.png',
                    '41_Multi-Site-Archaeological-Crime-Scene.png',
                    '42_River-Valley-Civilizations-Pattern.png',
                    '43_Witness-Interview-Dr-Elena-Rodriguez-Lead-Archaeologist.png',
                    '44_Ancient-Geographic-Technology.png',
                    '45_Historical-Geography-Challenge.png',
                    '46_Ancient-Civilization-Geographic-Comparison.png',
                    '47_CASE-SOLVED.png',
                    '48_Skills-Earned-Days-6-8.png',
                    '49_CASE-FILE-009-011.png',
                    '50_Days-9-11-The-Final-Confrontation.png',
                    '51_The-Cartographers-Master-Plan-Revealed.png',
                    '52_Global-Criminal-Network-Analysis.png',
                    '53_Elite-Task-Force-Assembly.png',
                    '54_Advanced-Geographic-Intelligence-Challenge.png',
                    '55_The-Cartographers-Location-Discovered.png',
                    '56_Epic-Geographic-Skills-Integration.png',
                    '57_The-Final-Confrontation.png',
                    '58_ULTIMATE-VICTORY.png',
                    '59_Your-Geographic-Detective-Academy-Graduation.png',
                    '60_Your-Geographic-Legacy.png'
                ];

                let thumbnailHTML = '';
                for (let i = 1; i <= this.totalSlides; i++) {
                    const currentFile = slideFiles[i - 1];
                    thumbnailHTML += `
                        <div class="thumbnail-item ${i === this.currentSlide ? 'active' : ''}" 
                             onclick="presentation.goToSlide(${i})" 
                             title="Slide ${i}">
                            <img src="${this.slidesPath}${currentFile}" 
                                 alt="Slide ${i} thumbnail"
                                 class="thumbnail-image">
                            <div class="thumbnail-number">${i}</div>
                        </div>
                    `;
                }
                thumbnailContainer.innerHTML = thumbnailHTML;
            }

            highlightCurrentThumbnail() {
                const thumbnails = document.querySelectorAll('.thumbnail-item');
                thumbnails.forEach((thumb, index) => {
                    if (index + 1 === this.currentSlide) {
                        thumb.classList.add('active');
                    } else {
                        thumb.classList.remove('active');
                    }
                });
            }

            toggleFullscreen() {
                const container = document.getElementById('presentation-container');
                if (!this.fullscreenMode) {
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    }
                    container.classList.add('fullscreen-mode');
                    this.fullscreenMode = true;
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    }
                    container.classList.remove('fullscreen-mode');
                    this.fullscreenMode = false;
                }
            }

            toggleAutoPlay() {
                this.autoPlay = !this.autoPlay;
                if (this.autoPlay) {
                    this.startAutoPlay();
                } else {
                    this.stopAutoPlay();
                }
            }

            startAutoPlay() {
                this.autoPlayInterval = setInterval(() => {
                    if (this.currentSlide < this.totalSlides) {
                        this.nextSlide();
                    } else {
                        this.stopAutoPlay();
                    }
                }, 5000); // 5 seconds per slide
            }

            stopAutoPlay() {
                if (this.autoPlayInterval) {
                    clearInterval(this.autoPlayInterval);
                    this.autoPlayInterval = null;
                }
                this.autoPlay = false;
            }

            setupKeyboardNavigation() {
                document.addEventListener('keydown', (e) => {
                    if (e.target.closest('.presentation-container')) {
                        switch (e.key) {
                            case 'ArrowRight':
                            case ' ':
                                e.preventDefault();
                                this.nextSlide();
                                break;
                            case 'ArrowLeft':
                                e.preventDefault();
                                this.previousSlide();
                                break;
                            case 'Home':
                                e.preventDefault();
                                this.goToSlide(1);
                                break;
                            case 'End':
                                e.preventDefault();
                                this.goToSlide(this.totalSlides);
                                break;
                            case 'Escape':
                                if (this.fullscreenMode) {
                                    this.toggleFullscreen();
                                }
                                break;
                        }
                    }
                });
            }

            downloadSlide() {
                const slideImage = document.getElementById('current-slide-image');
                if (slideImage) {
                    const link = document.createElement('a');
                    link.href = slideImage.src;
                    link.download = `geographic-detective-academy-slide-${this.currentSlide}.png`;
                    link.click();
                }
            }

            loadSlideNotes() {
                // This would typically load from a JSON file or API
                // For now, we'll use the default note generation
                console.log('üìù Slide notes loaded');
            }
        }

        // Initialize presentation system when page loads
        let presentation = null;
        
        window.addEventListener('DOMContentLoaded', () => {
            // Add presentation styles
            const style = document.createElement('style');
            style.textContent = `
                .presentation-container {
                    background: #1a1a1a;
                    color: white;
                    border-radius: 15px;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    margin: 1rem 0;
                }

                .presentation-header {
                    background: linear-gradient(135deg, #2c3e50, #3498db);
                    padding: 1rem 2rem;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }

                .presentation-title h2 {
                    margin: 0;
                    color: #ecf0f1;
                }

                .slide-counter {
                    color: #bdc3c7;
                    font-size: 0.9rem;
                    margin-top: 0.25rem;
                }

                .presentation-controls {
                    display: flex;
                    gap: 1rem;
                }

                .btn-control {
                    background: rgba(255,255,255,0.2);
                    border: none;
                    color: white;
                    padding: 0.5rem 1rem;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .btn-control:hover {
                    background: rgba(255,255,255,0.3);
                    transform: translateY(-2px);
                }

                .presentation-viewer {
                    display: grid;
                    grid-template-columns: 2fr 1fr;
                    gap: 1rem;
                    padding: 1rem;
                    min-height: 500px;
                }

                .slide-container {
                    position: relative;
                    background: #2c3e50;
                    border-radius: 10px;
                    overflow: hidden;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .slide-image {
                    max-width: 100%;
                    max-height: 100%;
                    object-fit: contain;
                    border-radius: 8px;
                }

                .slide-placeholder {
                    width: 100%;
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background: linear-gradient(145deg, #4a6741, #5a7751);
                    border-radius: 8px;
                    color: white;
                    text-align: center;
                }

                .placeholder-content {
                    padding: 2rem;
                }

                .placeholder-icon {
                    font-size: 4rem;
                    margin-bottom: 1rem;
                }

                .placeholder-content h3 {
                    margin: 0 0 1rem 0;
                    font-size: 1.5rem;
                }

                .placeholder-content p {
                    margin: 0 0 1rem 0;
                    font-size: 1.2rem;
                    color: #bdc3c7;
                }

                .placeholder-note {
                    background: rgba(0,0,0,0.3);
                    padding: 1rem;
                    border-radius: 5px;
                    font-size: 0.9rem;
                    color: #ecf0f1;
                }

                .slide-overlay {
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                    pointer-events: none;
                }

                .slide-container:hover .slide-overlay {
                    opacity: 1;
                    pointer-events: auto;
                }

                .nav-btn {
                    background: rgba(0,0,0,0.7);
                    border: none;
                    color: white;
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    cursor: pointer;
                    font-size: 1.2rem;
                    transition: all 0.3s ease;
                    margin: 0 1rem;
                }

                .nav-btn:hover {
                    background: rgba(0,0,0,0.9);
                    transform: scale(1.1);
                }

                .slide-notes-panel {
                    background: #34495e;
                    border-radius: 10px;
                    padding: 1.5rem;
                    overflow-y: auto;
                }

                .slide-notes-panel h4 {
                    margin: 0 0 1rem 0;
                    color: #ecf0f1;
                }

                .slide-note-item {
                    margin-bottom: 1.5rem;
                    padding-bottom: 1rem;
                    border-bottom: 1px solid #4a6741;
                }

                .slide-note-item h5 {
                    color: #3498db;
                    margin-bottom: 0.5rem;
                }

                .slide-note-item ul {
                    margin: 0;
                    padding-left: 1.5rem;
                }

                .slide-note-item li {
                    margin-bottom: 0.25rem;
                    color: #bdc3c7;
                }

                .presentation-footer {
                    background: #2c3e50;
                    padding: 1rem;
                }

                .slide-thumbnails {
                    display: flex;
                    gap: 0.5rem;
                    overflow-x: auto;
                    padding: 0.5rem 0;
                    margin-bottom: 1rem;
                }

                .thumbnail-item {
                    flex-shrink: 0;
                    width: 80px;
                    height: 60px;
                    border-radius: 5px;
                    overflow: hidden;
                    cursor: pointer;
                    position: relative;
                    border: 2px solid transparent;
                    transition: all 0.3s ease;
                }

                .thumbnail-item:hover,
                .thumbnail-item.active {
                    border-color: #3498db;
                    transform: scale(1.05);
                }

                .thumbnail-image {
                    width: 100%;
                    height: 100%;
                    object-fit: cover;
                }

                .thumbnail-number {
                    position: absolute;
                    bottom: 2px;
                    right: 2px;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    font-size: 0.7rem;
                    padding: 1px 4px;
                    border-radius: 3px;
                }

                .presentation-progress {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                }

                .progress-bar {
                    flex: 1;
                    height: 8px;
                    background: #4a6741;
                    border-radius: 4px;
                    overflow: hidden;
                }

                .progress-fill {
                    height: 100%;
                    background: linear-gradient(90deg, #3498db, #2ecc71);
                    transition: width 0.3s ease;
                }

                .slide-timer {
                    color: #bdc3c7;
                    font-family: monospace;
                    font-size: 0.9rem;
                }

                .fullscreen-mode {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    z-index: 9999;
                    border-radius: 0;
                }

                .fullscreen-mode .presentation-viewer {
                    grid-template-columns: 3fr 1fr;
                    height: calc(100vh - 200px);
                }

                @media (max-width: 768px) {
                    .presentation-viewer {
                        grid-template-columns: 1fr;
                    }
                    
                    .slide-notes-panel {
                        max-height: 200px;
                    }
                    
                    .presentation-header {
                        flex-direction: column;
                        gap: 1rem;
                    }
                    
                    .presentation-controls {
                        flex-wrap: wrap;
                        justify-content: center;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Initialize presentation system
            presentation = new SimulationPresentation();
            
            // Wait for gamma-prompts panel to be available
            function initializePresentationWhenReady() {
                const gammaPanel = document.getElementById('gamma-prompts');
                if (gammaPanel) {
                    presentation.addToPresentationPanel();
                    presentation.generateThumbnails();
                    console.log('üéÆ Presentation system initialized with 60 slides');
                } else {
                    // Try again in 500ms if panel not ready
                    setTimeout(initializePresentationWhenReady, 500);
                }
            }
            
            // Start initialization with a small delay
            setTimeout(initializePresentationWhenReady, 100);
        });
    </script>
</body>
</html>
